2025-05-26 14:49:40,223 - __main__ - INFO - Found 1 dependencies for use case UC5
2025-05-26 14:49:40,223 - __main__ - INFO - Read previously generated code for use case UC1 - test case UC1_TC1
2025-05-26 14:49:40,223 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt template loaded from path: ./prompts/single_processing/one_shot/raw.txt
2025-05-26 14:49:40,223 - test_code_generator.prompt_builder.prompt_builder - INFO - Test parameters loaded from path: ./input_files/parameters/test_parameters.env
2025-05-26 14:49:40,223 - test_code_generator.prompt_builder.prompt_builder - INFO - Test reporter loaded from path: ./input_files/reporter_minimal.js
2025-05-26 14:49:40,223 - test_code_generator.prompt_builder.prompt_builder - INFO - Previous code section loaded from path: ./input_files/reporter_minimal.js
2025-05-26 14:49:40,223 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt built: <|begin_of_text|><|start_header_id|>system<|end_header_id|>
You are a testing engineer, expert in writing Javascript end-to-end tests with Playwright.

Task: Analyze the test case provided below and generate a complete and working Playwright test script in Javascript, following the steps described in the test case.
When creating test scripts, use only the page object model provided for interacting with the DOM and the parameters provided.
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class SupportPage {
    constructor(page) {
      this.page = page;
      this.issueCategory = page.locator("#issue-category");
      this.issueDescription = page.locator("#issue-description");
      this.email = page.locator("#email");
      this.submit = page.getByRole("submit");
      this.errorMessage = page.locator('.error-message');
    }
  
    async selectIssueCategory(cateogry) {
        await this.issueCategory.selectOption(category);
    }
  
    async enterIssueDescription(description) {
        await this.issueDescription.fill(description);
    }
  
    async enterEmail(email) {
        await this.email.fill(email);
    }
  
    async getErrorMessage() {
        return await this.errorMessage.textContent();
    }

    async submitIssue() {
        await this.submit.click();
    }
  } 

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_SUPPORT_URL="https://pell-portal.bologna.enea.it/support/result"
E2E_SUPPORT_SUCCESS_URL = "https://pell-portal.bologna.enea.it/support/result"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC10_TC1
Title: Invia richiesta di assistenza
Use Case ID: UC10
Priority: Alta
Type: Positivo
Preconditions: Nessuna
Postconditions: L’utente è a conoscenza che l’operazione ha avuto successo
Test Steps:
  1. Step: L'utente naviga nella pagina di assistenza
Expected: La pagina di assistenza è visualizzata correttamente
  2. Step: L'utente compila la form di assistenza
Expected: Tutte le informazioni vengono accettate
  3. Step: Invia richiesta di assistenza
Expected: Si viene reindirizzati alla pagina di conferma

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
const { test, expect } = require('@playwright/test');
const SupportPage = require('../../models/page_object_models/support-page');
const TestResultReporter = require('../../models/test-result-reporter');

const reporter = new TestResultReporter();

// Step 1
const navigateToSupportPage = async function(page, reporter) {
  const startTime = new Date().getTime();
    await page.goto(process.env.E2E_SUPPORT_URL);
    const endTime = new Date().getTime();
    const executionTime = (endTime - startTime) / 1000;
    if (reporter) {
        reporter.addStep('U101_TC1_ID1', 'Navigate to support page', 'Support page loaded', 'Support page loaded', true, `E2E_SUPPORT_URL: ${process.env.E2E_SUPPORT_URL}`, executionTime);
    }
}

// Step 2
const fillSupportForm = async function(page, reporter) {
  const supportPage = new SupportPage(page);

  let startTime = Date.now();
  const category = "Problemi account";
  const description = "Non riesco più ad accedere al mio account";
  const email = "test.region@pell.it"
  await supportPage.selectIssueCategory();
  await supportPage.enterIssueDescription();
  await supportPage.enterEmail();
  let endTime = Date.now();
  reporter.addStep(
    'UC10_TC1_ID2',
    'L'utente compila la form di assistenza',
    `Form compilata`,
    `Form compilata`,
    true,
    { category, description, email },
    endTime - startTime
  );
}

// Step 3
const submitForm = async function (page, reporter) {
  const supportPage = new SupportPage(page);

  startTime = date.now();
  await supportPage.submitIssue();
  await page.waitForUrl(process.env.E2E_SUPPORT_SUCCESS_URL, { waitUnitl: "networkidle" });
  let testPass = page.url() == process.env.E2E_SUPPORT_SUCCESS_URL;
  endTime = date.now();
  reporter.addStep(
    'UC10_TC1_ID3',
    'Invia richiesta di assistenza',
    "L'utente viene reindirizzato alla pagina di avvenuto invio",
    testPass ? "L'utente viene reindirizzato alla pagina di avvenuto invio" : "Nessun reindirizzamento avvenuto",
    testPass,
    {},
    endTime - startTime
  );

}

test("UC10_TC1 - Invio richiesta di assistenza", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC10_TC1 - Invio richiesta di assistenza");

  const supportPage = new SupportPage(page);

  navigateToSupportPage(page, reporter);
  fillSupportForm(page, reporter);
  submitForm(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
}); 
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class HomePage {

    constructor(page) {
      this.page = page;
      this.dashboardButton = page.getByRole('link', { name: 'Dashboard' });
    }

    async navigateToDashboard() {
        await this.dashboardButton.click();
    }

    async navigateToCensimento() {
        await page.getByRole('link', { name: 'Scheda Censimento' }).click();
    }

    async clickOnProfile() {
        await page.getByLabel('user_data').click();
    }

    async changeLanguage() {
        await page.getByRole('link', { name: italianoFlagLink }).click();
        await page.getByRole('link', { name: ingleseFlagLink }).click();
    }
}

module.exports = HomePage;

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

When in the test case there is a step, a precondition or a postcondition with a name of use case UC*, reuse this functions passing null as reporter parameter:
<code>
const { test, expect } = require('@playwright/test');
const LoginPage = require('../../models/page_object_models/login-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

test("UC1_TC1 - Login con credenziali valide", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC1_TC1 - Login con credenziali valide");

  navigateToLoginPage(page, reporter);
  fillLoginForm(page, reporter);
  submitLoginForm(page, reporter);
  verifyAuthenticationSuccess(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
</code>

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC5_TC1
Title: Selezione lingua italiana
Use Case ID: UC5
Priority: Alto
Type: Positivo
Preconditions: UC1
Postconditions: L’utente visualizza il portale con la lingua selezionata
Test Steps:
  1. Step: L’utente clicca sul proprio nome utente in alto a destra
Expected: Viene visualizzato un menù a tendina
  2. Step: L’utente seleziona la lingua italiana dal menù a tendina
Expected: Il portale si ricarica con la lingua selezionata

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
2025-05-26 14:49:40,223 - test_code_generator.llm_client.ollama_client - INFO - OllamaClient initialized with model: llama3.3
2025-05-26 14:54:01,585 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/generate "HTTP/1.1 200 OK"
2025-05-26 14:54:01,585 - test_code_generator.llm_client.ollama_client - INFO - Ollama responded with: 
 

```javascript
const { test, expect } = require('@playwright/test');
const HomePage = require('../../models/page_object_models/home-page');
const TestResultReporter = require('../../models/test-result-reporter');
const LoginPage = require('../../models/page_object_models/login-page');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

const clickOnProfile = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.clickOnProfile();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC1_ID1', 'L’utente clicca sul proprio nome utente in alto a destra', 'Viene visualizzato un menù a tendina', 'Menù a tendina visualizzato', true, {}, executionTime);
  }
}

const changeLanguage = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.changeLanguage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC1_ID2', 'L’utente seleziona la lingua italiana dal menù a tendina', 'Il portale si ricarica con la lingua selezionata', 'Portale ricaricato con lingua italiana', true, {}, executionTime);
  }
}

test("UC5_TC1 - Selezione lingua italiana", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC5_TC1 - Selezione lingua italiana");

  navigateToLoginPage(page, null);
  fillLoginForm(page, null);
  submitLoginForm(page, null);
  verifyAuthenticationSuccess(page, null);

  clickOnProfile(page, reporter);
  changeLanguage(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
```
2025-05-26 14:54:01,585 - test_code_generator.validator.javascript_code_validator - INFO - Starting JavaScript code cleaning
2025-05-26 14:54:01,585 - test_code_generator.validator.javascript_code_validator - INFO - Extracting JavaScript code blocks
2025-05-26 14:54:01,585 - test_code_generator.validator.javascript_code_validator - INFO - Found 1 JavaScript code blocks with markdown syntax
2025-05-26 14:54:01,585 - test_code_generator.validator.javascript_code_validator - INFO - JavaScript code cleaning completed
2025-05-26 14:54:01,586 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt template loaded from path: ./prompts/single_processing/one_shot/raw.txt
2025-05-26 14:54:01,586 - test_code_generator.prompt_builder.prompt_builder - INFO - Test parameters loaded from path: ./input_files/parameters/test_parameters.env
2025-05-26 14:54:01,586 - test_code_generator.prompt_builder.prompt_builder - INFO - Test reporter loaded from path: ./input_files/reporter_minimal.js
2025-05-26 14:54:01,586 - test_code_generator.prompt_builder.prompt_builder - INFO - Previous code section loaded from path: ./input_files/reporter_minimal.js
2025-05-26 14:54:01,586 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt built: <|begin_of_text|><|start_header_id|>system<|end_header_id|>
You are a testing engineer, expert in writing Javascript end-to-end tests with Playwright.

Task: Analyze the test case provided below and generate a complete and working Playwright test script in Javascript, following the steps described in the test case.
When creating test scripts, use only the page object model provided for interacting with the DOM and the parameters provided.
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class SupportPage {
    constructor(page) {
      this.page = page;
      this.issueCategory = page.locator("#issue-category");
      this.issueDescription = page.locator("#issue-description");
      this.email = page.locator("#email");
      this.submit = page.getByRole("submit");
      this.errorMessage = page.locator('.error-message');
    }
  
    async selectIssueCategory(cateogry) {
        await this.issueCategory.selectOption(category);
    }
  
    async enterIssueDescription(description) {
        await this.issueDescription.fill(description);
    }
  
    async enterEmail(email) {
        await this.email.fill(email);
    }
  
    async getErrorMessage() {
        return await this.errorMessage.textContent();
    }

    async submitIssue() {
        await this.submit.click();
    }
  } 

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_SUPPORT_URL="https://pell-portal.bologna.enea.it/support/result"
E2E_SUPPORT_SUCCESS_URL = "https://pell-portal.bologna.enea.it/support/result"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC10_TC1
Title: Invia richiesta di assistenza
Use Case ID: UC10
Priority: Alta
Type: Positivo
Preconditions: Nessuna
Postconditions: L’utente è a conoscenza che l’operazione ha avuto successo
Test Steps:
  1. Step: L'utente naviga nella pagina di assistenza
Expected: La pagina di assistenza è visualizzata correttamente
  2. Step: L'utente compila la form di assistenza
Expected: Tutte le informazioni vengono accettate
  3. Step: Invia richiesta di assistenza
Expected: Si viene reindirizzati alla pagina di conferma

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
const { test, expect } = require('@playwright/test');
const SupportPage = require('../../models/page_object_models/support-page');
const TestResultReporter = require('../../models/test-result-reporter');

const reporter = new TestResultReporter();

// Step 1
const navigateToSupportPage = async function(page, reporter) {
  const startTime = new Date().getTime();
    await page.goto(process.env.E2E_SUPPORT_URL);
    const endTime = new Date().getTime();
    const executionTime = (endTime - startTime) / 1000;
    if (reporter) {
        reporter.addStep('U101_TC1_ID1', 'Navigate to support page', 'Support page loaded', 'Support page loaded', true, `E2E_SUPPORT_URL: ${process.env.E2E_SUPPORT_URL}`, executionTime);
    }
}

// Step 2
const fillSupportForm = async function(page, reporter) {
  const supportPage = new SupportPage(page);

  let startTime = Date.now();
  const category = "Problemi account";
  const description = "Non riesco più ad accedere al mio account";
  const email = "test.region@pell.it"
  await supportPage.selectIssueCategory();
  await supportPage.enterIssueDescription();
  await supportPage.enterEmail();
  let endTime = Date.now();
  reporter.addStep(
    'UC10_TC1_ID2',
    'L'utente compila la form di assistenza',
    `Form compilata`,
    `Form compilata`,
    true,
    { category, description, email },
    endTime - startTime
  );
}

// Step 3
const submitForm = async function (page, reporter) {
  const supportPage = new SupportPage(page);

  startTime = date.now();
  await supportPage.submitIssue();
  await page.waitForUrl(process.env.E2E_SUPPORT_SUCCESS_URL, { waitUnitl: "networkidle" });
  let testPass = page.url() == process.env.E2E_SUPPORT_SUCCESS_URL;
  endTime = date.now();
  reporter.addStep(
    'UC10_TC1_ID3',
    'Invia richiesta di assistenza',
    "L'utente viene reindirizzato alla pagina di avvenuto invio",
    testPass ? "L'utente viene reindirizzato alla pagina di avvenuto invio" : "Nessun reindirizzamento avvenuto",
    testPass,
    {},
    endTime - startTime
  );

}

test("UC10_TC1 - Invio richiesta di assistenza", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC10_TC1 - Invio richiesta di assistenza");

  const supportPage = new SupportPage(page);

  navigateToSupportPage(page, reporter);
  fillSupportForm(page, reporter);
  submitForm(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
}); 
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class HomePage {

    constructor(page) {
      this.page = page;
      this.dashboardButton = page.getByRole('link', { name: 'Dashboard' });
    }

    async navigateToDashboard() {
        await this.dashboardButton.click();
    }

    async navigateToCensimento() {
        await page.getByRole('link', { name: 'Scheda Censimento' }).click();
    }

    async clickOnProfile() {
        await page.getByLabel('user_data').click();
    }

    async changeLanguage() {
        await page.getByRole('link', { name: italianoFlagLink }).click();
        await page.getByRole('link', { name: ingleseFlagLink }).click();
    }
}

module.exports = HomePage;

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

When in the test case there is a step, a precondition or a postcondition with a name of use case UC*, reuse this functions passing null as reporter parameter:
<code>
const { test, expect } = require('@playwright/test');
const LoginPage = require('../../models/page_object_models/login-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

test("UC1_TC1 - Login con credenziali valide", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC1_TC1 - Login con credenziali valide");

  navigateToLoginPage(page, reporter);
  fillLoginForm(page, reporter);
  submitLoginForm(page, reporter);
  verifyAuthenticationSuccess(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
</code>

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC5_TC2
Title: Selezione lingua inglese
Use Case ID: UC5
Priority: Alto
Type: Positivo
Preconditions: UC1
Postconditions: L’utente visualizza il portale con la lingua selezionata
Test Steps:
  1. Step: L’utente clicca sul proprio nome utente in alto a destra
Expected: Viene visualizzato un menù a tendina
  2. Step: L’utente seleziona la lingua inglese dal menù a tendina
Expected: Il portale si ricarica con la lingua selezionata

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
2025-05-26 14:54:01,586 - test_code_generator.llm_client.ollama_client - INFO - OllamaClient initialized with model: llama3.3
2025-05-26 14:59:25,673 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/generate "HTTP/1.1 200 OK"
2025-05-26 14:59:25,673 - test_code_generator.llm_client.ollama_client - INFO - Ollama responded with: 
 

```javascript
const { test, expect } = require('@playwright/test');
const HomePage = require('../../models/page_object_models/home-page');
const TestResultReporter = require('../../models/test-result-reporter');
const LoginPage = require('../../models/page_object_models/login-page');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

const clickOnProfile = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.clickOnProfile();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC2_ID1', 'L’utente clicca sul proprio nome utente in alto a destra', 'Viene visualizzato un menù a tendina', 'Menù a tendina visualizzato', true, {}, executionTime);
  }
}

const changeLanguage = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.changeLanguage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC2_ID2', 'L’utente seleziona la lingua inglese dal menù a tendina', 'Il portale si ricarica con la lingua selezionata', 'Portale ricaricato con lingua inglese', true, {}, executionTime);
  }
}

test("UC5_TC2 - Selezione lingua inglese", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC5_TC2 - Selezione lingua inglese");

  navigateToLoginPage(page, null);
  fillLoginForm(page, null);
  submitLoginForm(page, null);
  verifyAuthenticationSuccess(page, null);

  clickOnProfile(page, reporter);
  changeLanguage(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
```
2025-05-26 14:59:25,673 - test_code_generator.validator.javascript_code_validator - INFO - Starting JavaScript code cleaning
2025-05-26 14:59:25,673 - test_code_generator.validator.javascript_code_validator - INFO - Extracting JavaScript code blocks
2025-05-26 14:59:25,673 - test_code_generator.validator.javascript_code_validator - INFO - Found 1 JavaScript code blocks with markdown syntax
2025-05-26 14:59:25,673 - test_code_generator.validator.javascript_code_validator - INFO - JavaScript code cleaning completed
2025-05-26 14:59:25,674 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt template loaded from path: ./prompts/single_processing/one_shot/raw.txt
2025-05-26 14:59:25,674 - test_code_generator.prompt_builder.prompt_builder - INFO - Test parameters loaded from path: ./input_files/parameters/test_parameters.env
2025-05-26 14:59:25,674 - test_code_generator.prompt_builder.prompt_builder - INFO - Test reporter loaded from path: ./input_files/reporter_minimal.js
2025-05-26 14:59:25,674 - test_code_generator.prompt_builder.prompt_builder - INFO - Previous code section loaded from path: ./input_files/reporter_minimal.js
2025-05-26 14:59:25,674 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt built: <|begin_of_text|><|start_header_id|>system<|end_header_id|>
You are a testing engineer, expert in writing Javascript end-to-end tests with Playwright.

Task: Analyze the test case provided below and generate a complete and working Playwright test script in Javascript, following the steps described in the test case.
When creating test scripts, use only the page object model provided for interacting with the DOM and the parameters provided.
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class SupportPage {
    constructor(page) {
      this.page = page;
      this.issueCategory = page.locator("#issue-category");
      this.issueDescription = page.locator("#issue-description");
      this.email = page.locator("#email");
      this.submit = page.getByRole("submit");
      this.errorMessage = page.locator('.error-message');
    }
  
    async selectIssueCategory(cateogry) {
        await this.issueCategory.selectOption(category);
    }
  
    async enterIssueDescription(description) {
        await this.issueDescription.fill(description);
    }
  
    async enterEmail(email) {
        await this.email.fill(email);
    }
  
    async getErrorMessage() {
        return await this.errorMessage.textContent();
    }

    async submitIssue() {
        await this.submit.click();
    }
  } 

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_SUPPORT_URL="https://pell-portal.bologna.enea.it/support/result"
E2E_SUPPORT_SUCCESS_URL = "https://pell-portal.bologna.enea.it/support/result"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC10_TC1
Title: Invia richiesta di assistenza
Use Case ID: UC10
Priority: Alta
Type: Positivo
Preconditions: Nessuna
Postconditions: L’utente è a conoscenza che l’operazione ha avuto successo
Test Steps:
  1. Step: L'utente naviga nella pagina di assistenza
Expected: La pagina di assistenza è visualizzata correttamente
  2. Step: L'utente compila la form di assistenza
Expected: Tutte le informazioni vengono accettate
  3. Step: Invia richiesta di assistenza
Expected: Si viene reindirizzati alla pagina di conferma

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
const { test, expect } = require('@playwright/test');
const SupportPage = require('../../models/page_object_models/support-page');
const TestResultReporter = require('../../models/test-result-reporter');

const reporter = new TestResultReporter();

// Step 1
const navigateToSupportPage = async function(page, reporter) {
  const startTime = new Date().getTime();
    await page.goto(process.env.E2E_SUPPORT_URL);
    const endTime = new Date().getTime();
    const executionTime = (endTime - startTime) / 1000;
    if (reporter) {
        reporter.addStep('U101_TC1_ID1', 'Navigate to support page', 'Support page loaded', 'Support page loaded', true, `E2E_SUPPORT_URL: ${process.env.E2E_SUPPORT_URL}`, executionTime);
    }
}

// Step 2
const fillSupportForm = async function(page, reporter) {
  const supportPage = new SupportPage(page);

  let startTime = Date.now();
  const category = "Problemi account";
  const description = "Non riesco più ad accedere al mio account";
  const email = "test.region@pell.it"
  await supportPage.selectIssueCategory();
  await supportPage.enterIssueDescription();
  await supportPage.enterEmail();
  let endTime = Date.now();
  reporter.addStep(
    'UC10_TC1_ID2',
    'L'utente compila la form di assistenza',
    `Form compilata`,
    `Form compilata`,
    true,
    { category, description, email },
    endTime - startTime
  );
}

// Step 3
const submitForm = async function (page, reporter) {
  const supportPage = new SupportPage(page);

  startTime = date.now();
  await supportPage.submitIssue();
  await page.waitForUrl(process.env.E2E_SUPPORT_SUCCESS_URL, { waitUnitl: "networkidle" });
  let testPass = page.url() == process.env.E2E_SUPPORT_SUCCESS_URL;
  endTime = date.now();
  reporter.addStep(
    'UC10_TC1_ID3',
    'Invia richiesta di assistenza',
    "L'utente viene reindirizzato alla pagina di avvenuto invio",
    testPass ? "L'utente viene reindirizzato alla pagina di avvenuto invio" : "Nessun reindirizzamento avvenuto",
    testPass,
    {},
    endTime - startTime
  );

}

test("UC10_TC1 - Invio richiesta di assistenza", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC10_TC1 - Invio richiesta di assistenza");

  const supportPage = new SupportPage(page);

  navigateToSupportPage(page, reporter);
  fillSupportForm(page, reporter);
  submitForm(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
}); 
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class HomePage {

    constructor(page) {
      this.page = page;
      this.dashboardButton = page.getByRole('link', { name: 'Dashboard' });
    }

    async navigateToDashboard() {
        await this.dashboardButton.click();
    }

    async navigateToCensimento() {
        await page.getByRole('link', { name: 'Scheda Censimento' }).click();
    }

    async clickOnProfile() {
        await page.getByLabel('user_data').click();
    }

    async changeLanguage() {
        await page.getByRole('link', { name: italianoFlagLink }).click();
        await page.getByRole('link', { name: ingleseFlagLink }).click();
    }
}

module.exports = HomePage;

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

When in the test case there is a step, a precondition or a postcondition with a name of use case UC*, reuse this functions passing null as reporter parameter:
<code>
const { test, expect } = require('@playwright/test');
const LoginPage = require('../../models/page_object_models/login-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

test("UC1_TC1 - Login con credenziali valide", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC1_TC1 - Login con credenziali valide");

  navigateToLoginPage(page, reporter);
  fillLoginForm(page, reporter);
  submitLoginForm(page, reporter);
  verifyAuthenticationSuccess(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
</code>

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC5_TC3
Title: Selezione lingua non supportata
Use Case ID: UC5
Priority: Basso
Type: Negativo
Preconditions: UC1
Postconditions: L’utente visualizza un messaggio di errore
Test Steps:
  1. Step: L’utente clicca sul proprio nome utente in alto a destra
Expected: Viene visualizzato un menù a tendina
  2. Step: L’utente seleziona una lingua non supportata dal menù a tendina
Expected: Viene visualizzato un messaggio di errore

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
2025-05-26 14:59:25,674 - test_code_generator.llm_client.ollama_client - INFO - OllamaClient initialized with model: llama3.3
2025-05-26 15:02:55,484 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/generate "HTTP/1.1 200 OK"
2025-05-26 15:02:55,485 - test_code_generator.llm_client.ollama_client - INFO - Ollama responded with: 
 

```javascript
const { test, expect } = require('@playwright/test');
const HomePage = require('../../models/page_object_models/home-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const clickOnProfile = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.clickOnProfile();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC3_ID1', 'L’utente clicca sul proprio nome utente in alto a destra', 'Viene visualizzato un menù a tendina', 'Menù a tendina visualizzato', true, {}, executionTime);
  }
  expect(await page.isVisible(homePage.page.getByRole('menu'))).toBeTruthy();
}

const changeLanguage = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.changeLanguage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC3_ID2', 'L’utente seleziona una lingua non supportata dal menù a tendina', 'Viene visualizzato un messaggio di errore', 'Messaggio di errore visualizzato', true, {}, executionTime);
  }
}

test("UC5_TC3 - Selezione lingua non supportata", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC5_TC3 - Selezione lingua non supportata");

  navigateToLoginPage(page, null);
  fillLoginForm(page, null);
  submitLoginForm(page, null);
  verifyAuthenticationSuccess(page, null);

  const homePage = new HomePage(page);
  clickOnProfile(page, reporter);
  changeLanguage(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
```
2025-05-26 15:02:55,485 - test_code_generator.validator.javascript_code_validator - INFO - Starting JavaScript code cleaning
2025-05-26 15:02:55,485 - test_code_generator.validator.javascript_code_validator - INFO - Extracting JavaScript code blocks
2025-05-26 15:02:55,485 - test_code_generator.validator.javascript_code_validator - INFO - Found 1 JavaScript code blocks with markdown syntax
2025-05-26 15:02:55,485 - test_code_generator.validator.javascript_code_validator - INFO - JavaScript code cleaning completed
2025-05-26 15:02:55,485 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt template loaded from path: ./prompts/single_processing/one_shot/raw.txt
2025-05-26 15:02:55,485 - test_code_generator.prompt_builder.prompt_builder - INFO - Test parameters loaded from path: ./input_files/parameters/test_parameters.env
2025-05-26 15:02:55,485 - test_code_generator.prompt_builder.prompt_builder - INFO - Test reporter loaded from path: ./input_files/reporter_minimal.js
2025-05-26 15:02:55,485 - test_code_generator.prompt_builder.prompt_builder - INFO - Previous code section loaded from path: ./input_files/reporter_minimal.js
2025-05-26 15:02:55,485 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt built: <|begin_of_text|><|start_header_id|>system<|end_header_id|>
You are a testing engineer, expert in writing Javascript end-to-end tests with Playwright.

Task: Analyze the test case provided below and generate a complete and working Playwright test script in Javascript, following the steps described in the test case.
When creating test scripts, use only the page object model provided for interacting with the DOM and the parameters provided.
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class SupportPage {
    constructor(page) {
      this.page = page;
      this.issueCategory = page.locator("#issue-category");
      this.issueDescription = page.locator("#issue-description");
      this.email = page.locator("#email");
      this.submit = page.getByRole("submit");
      this.errorMessage = page.locator('.error-message');
    }
  
    async selectIssueCategory(cateogry) {
        await this.issueCategory.selectOption(category);
    }
  
    async enterIssueDescription(description) {
        await this.issueDescription.fill(description);
    }
  
    async enterEmail(email) {
        await this.email.fill(email);
    }
  
    async getErrorMessage() {
        return await this.errorMessage.textContent();
    }

    async submitIssue() {
        await this.submit.click();
    }
  } 

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_SUPPORT_URL="https://pell-portal.bologna.enea.it/support/result"
E2E_SUPPORT_SUCCESS_URL = "https://pell-portal.bologna.enea.it/support/result"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC10_TC1
Title: Invia richiesta di assistenza
Use Case ID: UC10
Priority: Alta
Type: Positivo
Preconditions: Nessuna
Postconditions: L’utente è a conoscenza che l’operazione ha avuto successo
Test Steps:
  1. Step: L'utente naviga nella pagina di assistenza
Expected: La pagina di assistenza è visualizzata correttamente
  2. Step: L'utente compila la form di assistenza
Expected: Tutte le informazioni vengono accettate
  3. Step: Invia richiesta di assistenza
Expected: Si viene reindirizzati alla pagina di conferma

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
const { test, expect } = require('@playwright/test');
const SupportPage = require('../../models/page_object_models/support-page');
const TestResultReporter = require('../../models/test-result-reporter');

const reporter = new TestResultReporter();

// Step 1
const navigateToSupportPage = async function(page, reporter) {
  const startTime = new Date().getTime();
    await page.goto(process.env.E2E_SUPPORT_URL);
    const endTime = new Date().getTime();
    const executionTime = (endTime - startTime) / 1000;
    if (reporter) {
        reporter.addStep('U101_TC1_ID1', 'Navigate to support page', 'Support page loaded', 'Support page loaded', true, `E2E_SUPPORT_URL: ${process.env.E2E_SUPPORT_URL}`, executionTime);
    }
}

// Step 2
const fillSupportForm = async function(page, reporter) {
  const supportPage = new SupportPage(page);

  let startTime = Date.now();
  const category = "Problemi account";
  const description = "Non riesco più ad accedere al mio account";
  const email = "test.region@pell.it"
  await supportPage.selectIssueCategory();
  await supportPage.enterIssueDescription();
  await supportPage.enterEmail();
  let endTime = Date.now();
  reporter.addStep(
    'UC10_TC1_ID2',
    'L'utente compila la form di assistenza',
    `Form compilata`,
    `Form compilata`,
    true,
    { category, description, email },
    endTime - startTime
  );
}

// Step 3
const submitForm = async function (page, reporter) {
  const supportPage = new SupportPage(page);

  startTime = date.now();
  await supportPage.submitIssue();
  await page.waitForUrl(process.env.E2E_SUPPORT_SUCCESS_URL, { waitUnitl: "networkidle" });
  let testPass = page.url() == process.env.E2E_SUPPORT_SUCCESS_URL;
  endTime = date.now();
  reporter.addStep(
    'UC10_TC1_ID3',
    'Invia richiesta di assistenza',
    "L'utente viene reindirizzato alla pagina di avvenuto invio",
    testPass ? "L'utente viene reindirizzato alla pagina di avvenuto invio" : "Nessun reindirizzamento avvenuto",
    testPass,
    {},
    endTime - startTime
  );

}

test("UC10_TC1 - Invio richiesta di assistenza", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC10_TC1 - Invio richiesta di assistenza");

  const supportPage = new SupportPage(page);

  navigateToSupportPage(page, reporter);
  fillSupportForm(page, reporter);
  submitForm(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
}); 
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class HomePage {

    constructor(page) {
      this.page = page;
      this.dashboardButton = page.getByRole('link', { name: 'Dashboard' });
    }

    async navigateToDashboard() {
        await this.dashboardButton.click();
    }

    async navigateToCensimento() {
        await page.getByRole('link', { name: 'Scheda Censimento' }).click();
    }

    async clickOnProfile() {
        await page.getByLabel('user_data').click();
    }

    async changeLanguage() {
        await page.getByRole('link', { name: italianoFlagLink }).click();
        await page.getByRole('link', { name: ingleseFlagLink }).click();
    }
}

module.exports = HomePage;

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

When in the test case there is a step, a precondition or a postcondition with a name of use case UC*, reuse this functions passing null as reporter parameter:
<code>
const { test, expect } = require('@playwright/test');
const LoginPage = require('../../models/page_object_models/login-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

test("UC1_TC1 - Login con credenziali valide", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC1_TC1 - Login con credenziali valide");

  navigateToLoginPage(page, reporter);
  fillLoginForm(page, reporter);
  submitLoginForm(page, reporter);
  verifyAuthenticationSuccess(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
</code>

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC5_TC4
Title: Selezione lingua senza cliccare sul nome utente
Use Case ID: UC5
Priority: Basso
Type: Negativo
Preconditions: UC1
Postconditions: L’utente non visualizza il menù a tendina
Test Steps:
  1. Step: L’utente non clicca sul proprio nome utente in alto a destra
Expected: Il menù a tendina non viene visualizzato

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
2025-05-26 15:02:55,485 - test_code_generator.llm_client.ollama_client - INFO - OllamaClient initialized with model: llama3.3
2025-05-26 15:04:30,769 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/generate "HTTP/1.1 200 OK"
2025-05-26 15:04:30,769 - test_code_generator.llm_client.ollama_client - INFO - Ollama responded with: 
 

```javascript
const { test, expect } = require('@playwright/test');
const HomePage = require('../../models/page_object_models/home-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const navigateToHomePage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_BASE_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC4_ID1', 'Navigate to home page', 'Home page loaded', 'Home page loaded', true, `E2E_BASE_URL: ${process.env.E2E_BASE_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_BASE_URL);
}

const doNotClickOnProfile = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  // No action is performed
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC4_ID2', 'L’utente non clicca sul proprio nome utente in alto a destra', 'Il menù a tendina non viene visualizzato', 'Il menù a tendina non viene visualizzato', true, {}, executionTime);
  }
  const dropdownVisible = await page.isVisible('#dropdown-menu');
  expect(dropdownVisible).toBeFalsy();
}

test("UC5_TC4 - Selezione lingua senza cliccare sul nome utente", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC5_TC4 - Selezione lingua senza cliccare sul nome utente");

  navigateToLoginPage(page, null);
  fillLoginForm(page, null);
  submitLoginForm(page, null);
  verifyAuthenticationSuccess(page, null);

  navigateToHomePage(page, reporter);
  doNotClickOnProfile(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
```
2025-05-26 15:04:30,769 - test_code_generator.validator.javascript_code_validator - INFO - Starting JavaScript code cleaning
2025-05-26 15:04:30,769 - test_code_generator.validator.javascript_code_validator - INFO - Extracting JavaScript code blocks
2025-05-26 15:04:30,769 - test_code_generator.validator.javascript_code_validator - INFO - Found 1 JavaScript code blocks with markdown syntax
2025-05-26 15:04:30,769 - test_code_generator.validator.javascript_code_validator - INFO - JavaScript code cleaning completed
2025-05-26 15:04:30,770 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt template loaded from path: ./prompts/single_processing/one_shot/raw.txt
2025-05-26 15:04:30,770 - test_code_generator.prompt_builder.prompt_builder - INFO - Test parameters loaded from path: ./input_files/parameters/test_parameters.env
2025-05-26 15:04:30,770 - test_code_generator.prompt_builder.prompt_builder - INFO - Test reporter loaded from path: ./input_files/reporter_minimal.js
2025-05-26 15:04:30,770 - test_code_generator.prompt_builder.prompt_builder - INFO - Previous code section loaded from path: ./input_files/reporter_minimal.js
2025-05-26 15:04:30,770 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt built: <|begin_of_text|><|start_header_id|>system<|end_header_id|>
You are a testing engineer, expert in writing Javascript end-to-end tests with Playwright.

Task: Analyze the test case provided below and generate a complete and working Playwright test script in Javascript, following the steps described in the test case.
When creating test scripts, use only the page object model provided for interacting with the DOM and the parameters provided.
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class SupportPage {
    constructor(page) {
      this.page = page;
      this.issueCategory = page.locator("#issue-category");
      this.issueDescription = page.locator("#issue-description");
      this.email = page.locator("#email");
      this.submit = page.getByRole("submit");
      this.errorMessage = page.locator('.error-message');
    }
  
    async selectIssueCategory(cateogry) {
        await this.issueCategory.selectOption(category);
    }
  
    async enterIssueDescription(description) {
        await this.issueDescription.fill(description);
    }
  
    async enterEmail(email) {
        await this.email.fill(email);
    }
  
    async getErrorMessage() {
        return await this.errorMessage.textContent();
    }

    async submitIssue() {
        await this.submit.click();
    }
  } 

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_SUPPORT_URL="https://pell-portal.bologna.enea.it/support/result"
E2E_SUPPORT_SUCCESS_URL = "https://pell-portal.bologna.enea.it/support/result"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC10_TC1
Title: Invia richiesta di assistenza
Use Case ID: UC10
Priority: Alta
Type: Positivo
Preconditions: Nessuna
Postconditions: L’utente è a conoscenza che l’operazione ha avuto successo
Test Steps:
  1. Step: L'utente naviga nella pagina di assistenza
Expected: La pagina di assistenza è visualizzata correttamente
  2. Step: L'utente compila la form di assistenza
Expected: Tutte le informazioni vengono accettate
  3. Step: Invia richiesta di assistenza
Expected: Si viene reindirizzati alla pagina di conferma

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
const { test, expect } = require('@playwright/test');
const SupportPage = require('../../models/page_object_models/support-page');
const TestResultReporter = require('../../models/test-result-reporter');

const reporter = new TestResultReporter();

// Step 1
const navigateToSupportPage = async function(page, reporter) {
  const startTime = new Date().getTime();
    await page.goto(process.env.E2E_SUPPORT_URL);
    const endTime = new Date().getTime();
    const executionTime = (endTime - startTime) / 1000;
    if (reporter) {
        reporter.addStep('U101_TC1_ID1', 'Navigate to support page', 'Support page loaded', 'Support page loaded', true, `E2E_SUPPORT_URL: ${process.env.E2E_SUPPORT_URL}`, executionTime);
    }
}

// Step 2
const fillSupportForm = async function(page, reporter) {
  const supportPage = new SupportPage(page);

  let startTime = Date.now();
  const category = "Problemi account";
  const description = "Non riesco più ad accedere al mio account";
  const email = "test.region@pell.it"
  await supportPage.selectIssueCategory();
  await supportPage.enterIssueDescription();
  await supportPage.enterEmail();
  let endTime = Date.now();
  reporter.addStep(
    'UC10_TC1_ID2',
    'L'utente compila la form di assistenza',
    `Form compilata`,
    `Form compilata`,
    true,
    { category, description, email },
    endTime - startTime
  );
}

// Step 3
const submitForm = async function (page, reporter) {
  const supportPage = new SupportPage(page);

  startTime = date.now();
  await supportPage.submitIssue();
  await page.waitForUrl(process.env.E2E_SUPPORT_SUCCESS_URL, { waitUnitl: "networkidle" });
  let testPass = page.url() == process.env.E2E_SUPPORT_SUCCESS_URL;
  endTime = date.now();
  reporter.addStep(
    'UC10_TC1_ID3',
    'Invia richiesta di assistenza',
    "L'utente viene reindirizzato alla pagina di avvenuto invio",
    testPass ? "L'utente viene reindirizzato alla pagina di avvenuto invio" : "Nessun reindirizzamento avvenuto",
    testPass,
    {},
    endTime - startTime
  );

}

test("UC10_TC1 - Invio richiesta di assistenza", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC10_TC1 - Invio richiesta di assistenza");

  const supportPage = new SupportPage(page);

  navigateToSupportPage(page, reporter);
  fillSupportForm(page, reporter);
  submitForm(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
}); 
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class HomePage {

    constructor(page) {
      this.page = page;
      this.dashboardButton = page.getByRole('link', { name: 'Dashboard' });
    }

    async navigateToDashboard() {
        await this.dashboardButton.click();
    }

    async navigateToCensimento() {
        await page.getByRole('link', { name: 'Scheda Censimento' }).click();
    }

    async clickOnProfile() {
        await page.getByLabel('user_data').click();
    }

    async changeLanguage() {
        await page.getByRole('link', { name: italianoFlagLink }).click();
        await page.getByRole('link', { name: ingleseFlagLink }).click();
    }
}

module.exports = HomePage;

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

When in the test case there is a step, a precondition or a postcondition with a name of use case UC*, reuse this functions passing null as reporter parameter:
<code>
const { test, expect } = require('@playwright/test');
const LoginPage = require('../../models/page_object_models/login-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

test("UC1_TC1 - Login con credenziali valide", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC1_TC1 - Login con credenziali valide");

  navigateToLoginPage(page, reporter);
  fillLoginForm(page, reporter);
  submitLoginForm(page, reporter);
  verifyAuthenticationSuccess(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
</code>

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC5_TC5
Title: Selezione lingua con più clic sul nome utente
Use Case ID: UC5
Priority: Basso
Type: Negativo
Preconditions: UC1
Postconditions: L’utente visualizza il menù a tendina solo al primo clic
Test Steps:
  1. Step: L’utente clicca più volte sul proprio nome utente in alto a destra
Expected: Il menù a tendina viene visualizzato solo al primo clic

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
2025-05-26 15:04:30,770 - test_code_generator.llm_client.ollama_client - INFO - OllamaClient initialized with model: llama3.3
2025-05-26 15:06:10,389 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/generate "HTTP/1.1 200 OK"
2025-05-26 15:06:10,389 - test_code_generator.llm_client.ollama_client - INFO - Ollama responded with: 
 

```javascript
const { test, expect } = require('@playwright/test');
const HomePage = require('../../models/page_object_models/home-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const clickOnProfileMultipleTimes = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.clickOnProfile();
  await homePage.clickOnProfile();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC5_ID1', 'L’utente clicca più volte sul proprio nome utente', 'Il menù a tendina viene visualizzato solo al primo clic', 'Il menù a tendina viene visualizzato solo al primo clic', true, {}, executionTime);
  }
}

const verifyDropdownVisibility = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  const dropdownVisible = await page.isVisible('#dropdown-menu');
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC5_ID2', 'Verifica la visibilità del menù a tendina', 'Il menù a tendina è visibile solo al primo clic', dropdownVisible ? 'Visibile' : 'Non visibile', !dropdownVisible, {}, executionTime);
  }
  expect(dropdownVisible).toBeFalsy();
}

test("UC5_TC5 - Selezione lingua con più clic sul nome utente", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC5_TC5 - Selezione lingua con più clic sul nome utente");

  navigateToLoginPage(page, null);
  fillLoginForm(page, null);
  submitLoginForm(page, null);
  verifyAuthenticationSuccess(page, null);

  const homePage = new HomePage(page);
  await homePage.navigateToDashboard();

  clickOnProfileMultipleTimes(page, reporter);
  verifyDropdownVisibility(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
```
2025-05-26 15:06:10,389 - test_code_generator.validator.javascript_code_validator - INFO - Starting JavaScript code cleaning
2025-05-26 15:06:10,389 - test_code_generator.validator.javascript_code_validator - INFO - Extracting JavaScript code blocks
2025-05-26 15:06:10,389 - test_code_generator.validator.javascript_code_validator - INFO - Found 1 JavaScript code blocks with markdown syntax
2025-05-26 15:06:10,389 - test_code_generator.validator.javascript_code_validator - INFO - JavaScript code cleaning completed
2025-05-26 15:06:10,389 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt template loaded from path: ./prompts/single_processing/one_shot/raw.txt
2025-05-26 15:06:10,389 - test_code_generator.prompt_builder.prompt_builder - INFO - Test parameters loaded from path: ./input_files/parameters/test_parameters.env
2025-05-26 15:06:10,389 - test_code_generator.prompt_builder.prompt_builder - INFO - Test reporter loaded from path: ./input_files/reporter_minimal.js
2025-05-26 15:06:10,389 - test_code_generator.prompt_builder.prompt_builder - INFO - Previous code section loaded from path: ./input_files/reporter_minimal.js
2025-05-26 15:06:10,389 - test_code_generator.prompt_builder.prompt_builder - INFO - Prompt built: <|begin_of_text|><|start_header_id|>system<|end_header_id|>
You are a testing engineer, expert in writing Javascript end-to-end tests with Playwright.

Task: Analyze the test case provided below and generate a complete and working Playwright test script in Javascript, following the steps described in the test case.
When creating test scripts, use only the page object model provided for interacting with the DOM and the parameters provided.
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class SupportPage {
    constructor(page) {
      this.page = page;
      this.issueCategory = page.locator("#issue-category");
      this.issueDescription = page.locator("#issue-description");
      this.email = page.locator("#email");
      this.submit = page.getByRole("submit");
      this.errorMessage = page.locator('.error-message');
    }
  
    async selectIssueCategory(cateogry) {
        await this.issueCategory.selectOption(category);
    }
  
    async enterIssueDescription(description) {
        await this.issueDescription.fill(description);
    }
  
    async enterEmail(email) {
        await this.email.fill(email);
    }
  
    async getErrorMessage() {
        return await this.errorMessage.textContent();
    }

    async submitIssue() {
        await this.submit.click();
    }
  } 

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_SUPPORT_URL="https://pell-portal.bologna.enea.it/support/result"
E2E_SUPPORT_SUCCESS_URL = "https://pell-portal.bologna.enea.it/support/result"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC10_TC1
Title: Invia richiesta di assistenza
Use Case ID: UC10
Priority: Alta
Type: Positivo
Preconditions: Nessuna
Postconditions: L’utente è a conoscenza che l’operazione ha avuto successo
Test Steps:
  1. Step: L'utente naviga nella pagina di assistenza
Expected: La pagina di assistenza è visualizzata correttamente
  2. Step: L'utente compila la form di assistenza
Expected: Tutte le informazioni vengono accettate
  3. Step: Invia richiesta di assistenza
Expected: Si viene reindirizzati alla pagina di conferma

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
const { test, expect } = require('@playwright/test');
const SupportPage = require('../../models/page_object_models/support-page');
const TestResultReporter = require('../../models/test-result-reporter');

const reporter = new TestResultReporter();

// Step 1
const navigateToSupportPage = async function(page, reporter) {
  const startTime = new Date().getTime();
    await page.goto(process.env.E2E_SUPPORT_URL);
    const endTime = new Date().getTime();
    const executionTime = (endTime - startTime) / 1000;
    if (reporter) {
        reporter.addStep('U101_TC1_ID1', 'Navigate to support page', 'Support page loaded', 'Support page loaded', true, `E2E_SUPPORT_URL: ${process.env.E2E_SUPPORT_URL}`, executionTime);
    }
}

// Step 2
const fillSupportForm = async function(page, reporter) {
  const supportPage = new SupportPage(page);

  let startTime = Date.now();
  const category = "Problemi account";
  const description = "Non riesco più ad accedere al mio account";
  const email = "test.region@pell.it"
  await supportPage.selectIssueCategory();
  await supportPage.enterIssueDescription();
  await supportPage.enterEmail();
  let endTime = Date.now();
  reporter.addStep(
    'UC10_TC1_ID2',
    'L'utente compila la form di assistenza',
    `Form compilata`,
    `Form compilata`,
    true,
    { category, description, email },
    endTime - startTime
  );
}

// Step 3
const submitForm = async function (page, reporter) {
  const supportPage = new SupportPage(page);

  startTime = date.now();
  await supportPage.submitIssue();
  await page.waitForUrl(process.env.E2E_SUPPORT_SUCCESS_URL, { waitUnitl: "networkidle" });
  let testPass = page.url() == process.env.E2E_SUPPORT_SUCCESS_URL;
  endTime = date.now();
  reporter.addStep(
    'UC10_TC1_ID3',
    'Invia richiesta di assistenza',
    "L'utente viene reindirizzato alla pagina di avvenuto invio",
    testPass ? "L'utente viene reindirizzato alla pagina di avvenuto invio" : "Nessun reindirizzamento avvenuto",
    testPass,
    {},
    endTime - startTime
  );

}

test("UC10_TC1 - Invio richiesta di assistenza", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC10_TC1 - Invio richiesta di assistenza");

  const supportPage = new SupportPage(page);

  navigateToSupportPage(page, reporter);
  fillSupportForm(page, reporter);
  submitForm(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
}); 
<|eot_id|>
<|start_header_id|>user<|end_header_id|>
Use only this page object models for interacting with the DOM:
class HomePage {

    constructor(page) {
      this.page = page;
      this.dashboardButton = page.getByRole('link', { name: 'Dashboard' });
    }

    async navigateToDashboard() {
        await this.dashboardButton.click();
    }

    async navigateToCensimento() {
        await page.getByRole('link', { name: 'Scheda Censimento' }).click();
    }

    async clickOnProfile() {
        await page.getByLabel('user_data').click();
    }

    async changeLanguage() {
        await page.getByRole('link', { name: italianoFlagLink }).click();
        await page.getByRole('link', { name: ingleseFlagLink }).click();
    }
}

module.exports = HomePage;

Use only the following parameters from environment variables in the test scripts:
E2E_BASE_URL="http://pell-portal.bologna.enea.it/"
E2E_LOGIN_URL="https://idp.smartcityplatform.enea.it/"
E2E_HOME_URL="" 
E2E_DASHBOARD_URL="" 
E2E_CTS_URL="" 
E2E_LOGIN_EMAIL_ADMIN="test.admin@pell.it"
E2E_LOGIN_PASSWORD_ADMIN="Testadmin01!"
E2E_LOGIN_EMAIL_REGION="test.region@pell.it"
E2E_LOGIN_PASSWORD_REGION="Testregion01!"

When in the test case there is a step, a precondition or a postcondition with a name of use case UC*, reuse this functions passing null as reporter parameter:
<code>
const { test, expect } = require('@playwright/test');
const LoginPage = require('../../models/page_object_models/login-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const navigateToLoginPage = async function(page, reporter) {
  const startTime = new Date().getTime();
  await page.goto(process.env.E2E_LOGIN_URL);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID1', 'Navigate to login page', 'Login page loaded', 'Login page loaded', true, `E2E_LOGIN_URL: ${process.env.E2E_LOGIN_URL}`, executionTime);
  }
  expect(page.url()).toBe(process.env.E2E_LOGIN_URL);
}

const fillLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.displayLoginForm();
  await loginPage.enterEmail(process.env.E2E_LOGIN_EMAIL_ADMIN);
  await loginPage.enterPassword(process.env.E2E_LOGIN_PASSWORD_ADMIN);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID2', 'Inserisci le credenziali corrette nel form di login', `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, `Credenziali inserite: email=${process.env.E2E_LOGIN_EMAIL_ADMIN}, password=***`, true, { email: process.env.E2E_LOGIN_EMAIL_ADMIN, password: '***' }, executionTime);
  }
}

const submitLoginForm = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  await loginPage.login();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID3', 'Clicca il tasto “Login”', 'Il sistema procede con l’autenticazione', 'Il sistema procede con l’autenticazione', true, {}, executionTime);
  }
}

const verifyAuthenticationSuccess = async function(page, reporter) {
  const loginPage = new LoginPage(page);
  const startTime = new Date().getTime();
  const errorMessage = await loginPage.getErrorMessage();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC1_TC1_ID4', 'Verifica la visualizzazione del messaggio di successo', 'Viene mostrato un messaggio che conferma l’avvenuta autenticazione', errorMessage ? `Errore: ${errorMessage}` : 'Autenticazione avvenuta con successo', !errorMessage, {}, executionTime);
  }
  expect(errorMessage).toBeNull();
}

test("UC1_TC1 - Login con credenziali valide", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC1_TC1 - Login con credenziali valide");

  navigateToLoginPage(page, reporter);
  fillLoginForm(page, reporter);
  submitLoginForm(page, reporter);
  verifyAuthenticationSuccess(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
</code>

Instructions:
1. Analyze the test case provided
2. For the test case, generate a test script in Javascript with Playwright
3. Use only Page object model provided to interact with the DOM.
4. Call the TestResultReporter object methods as described below.
5. Add the required import for Playwright, TestResultReporter from "../../models/test-result-reporter", page object models from "../../models/page_object_models/"
6. Put the code in functions for reusability, with the reporter object as parameter not mandatory. If not null, call reporter methods.

<example>
const functionNameDescribingStep = async function(page, reporter) {
    const startTime = DateTime.now();
    
    // Put here test case step implementation
    
    const endTime = DateTime.now();
    const executionTime = endTime - startTime;
    if (reporter) {
        reporter.addStep('UC1_TC1_ID1', 'Step 1 description', expectedResults, actualResults, passFail, parametersUsed, executionTime);
    }

    // Include Playwright assertions
    expect(condition);
}

test("UC1_TC1 - Login test with success", async ({page, browserName}) => {
    reporter.setBrowserName(browserName);
    reporter.setTestCase("UC1_TC1 - Login test with success");

    // Call step functions in sequence
    step1(page, reporter);
    step2(page, reporter);
    // Additional steps...

    reporter.onTestEnd(test, { status: "passed" });     // status can be "passed" or "failed" 
});
</example>

Here the test case to be converted in Playwright script:
Test Case ID: UC5_TC6
Title: Selezione lingua senza selezionare una opzione dal menù a tendina
Use Case ID: UC5
Priority: Basso
Type: Negativo
Preconditions: UC1
Postconditions: L’utente non visualizza alcun cambiamento
Test Steps:
  1. Step: L’utente clicca sul proprio nome utente in alto a destra
Expected: Viene visualizzato un menù a tendina
  2. Step: L’utente non seleziona alcuna opzione dal menù a tendina
Expected: Il portale non cambia lingua

Output only valid and runnable JavaScript code with no explanations or markdown formatting. Do not copy existing code implementation in the response, only reference it.
<|eot_id|>
<|start_header_id|>assistant<|end_header_id|>
2025-05-26 15:06:10,389 - test_code_generator.llm_client.ollama_client - INFO - OllamaClient initialized with model: llama3.3
2025-05-26 15:07:52,078 - httpx - INFO - HTTP Request: POST http://127.0.0.1:11434/api/generate "HTTP/1.1 200 OK"
2025-05-26 15:07:52,079 - test_code_generator.llm_client.ollama_client - INFO - Ollama responded with: 
 

```javascript
const { test, expect } = require('@playwright/test');
const HomePage = require('../../models/page_object_models/home-page');
const TestResultReporter = require('../../models/test-result-reporter');

let reporter = new TestResultReporter();

const clickOnProfile = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await homePage.clickOnProfile();
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC6_ID1', 'L’utente clicca sul proprio nome utente in alto a destra', 'Viene visualizzato un menù a tendina', 'Menù a tendina visualizzato', true, {}, executionTime);
  }
  expect(await page.isVisible(homePage.page.getByRole('menu'))).toBeTruthy();
}

const verifyNoLanguageChange = async function(page, reporter) {
  const homePage = new HomePage(page);
  const startTime = new Date().getTime();
  await page.waitForTimeout(1000);
  const endTime = new Date().getTime();
  const executionTime = (endTime - startTime) / 1000;
  if (reporter) {
    reporter.addStep('UC5_TC6_ID2', 'L’utente non seleziona alcuna opzione dal menù a tendina', 'Il portale non cambia lingua', 'Nessun cambiamento di lingua rilevato', true, {}, executionTime);
  }
  expect(await page.url()).toBe(process.env.E2E_BASE_URL);
}

test("UC5_TC6 - Selezione lingua senza selezionare una opzione dal menù a tendina", async ({ page, browserName }) => {
  reporter.setBrowserName(browserName);
  reporter.setTestCase("UC5_TC6 - Selezione lingua senza selezionare una opzione dal menù a tendina");

  navigateToLoginPage(page, null);
  fillLoginForm(page, null);
  submitLoginForm(page, null);
  verifyAuthenticationSuccess(page, null);

  clickOnProfile(page, reporter);
  verifyNoLanguageChange(page, reporter);

  reporter.onTestEnd(test, { status: "passed" });
});
```
2025-05-26 15:07:52,079 - test_code_generator.validator.javascript_code_validator - INFO - Starting JavaScript code cleaning
2025-05-26 15:07:52,079 - test_code_generator.validator.javascript_code_validator - INFO - Extracting JavaScript code blocks
2025-05-26 15:07:52,079 - test_code_generator.validator.javascript_code_validator - INFO - Found 1 JavaScript code blocks with markdown syntax
2025-05-26 15:07:52,079 - test_code_generator.validator.javascript_code_validator - INFO - JavaScript code cleaning completed
